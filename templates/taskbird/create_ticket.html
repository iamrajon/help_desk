{% extends "dashboard/customer.html" %}
{% load static %}


{% block customer_ticket_form %}

<div class="container max-w-2xl mx-auto p-6 bg-white rounded-lg shadow-lg mt-8">
    <h2 class="text-2xl font-bold text-gray-800 mb-6">Create a New Ticket</h2>
    {% if messages %}
        <div id="alert" class="bg-blue-100 border-l-4 border-blue-500 text-blue-700 p-4 mb-6 relative" role="alert">
            {% for message in messages %}
                <p class="{% if message.tags == 'error' %}text-red-700 bg-red-100 border-red-500{% else %}text-green-700 bg-green-100 border-green-500{% endif %}">
                    {{ message }}
                </p>
            {% endfor %}
            <button onclick="document.getElementById('alert').style.display='none'" class="absolute top-0 right-0 p-4 text-blue-700 hover:text-blue-900">
                <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z" clip-rule="evenodd"/>
                </svg>
            </button>
        </div>
    {% endif %}
    <form method="post" action="{% url 'create-ticket' %}" enctype="multipart/form-data" class="space-y-4">
        {% csrf_token %}
        <div>
            <label for="{{ form.title.id_for_label }}" class="block text-sm font-medium text-gray-700">Title</label>
            <input type="text" name="{{ form.title.name }}" id="{{ form.title.id_for_label }}"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
                    placeholder="Enter ticket title" value="{{ form.title.value|default_if_none:'' }}">
            {% if form.title.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.title.errors }}</p>
            {% endif %}
        </div>
        <div>
            <label for="{{ form.description.id_for_label }}" class="block text-sm font-medium text-gray-700">Description</label>
            <textarea name="{{ form.description.name }}" id="{{ form.description.id_for_label }}"
                        class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm"
                        rows="5" placeholder="Describe your issue">{{ form.description.value|default_if_none:'' }}</textarea>
            {% if form.description.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.description.errors }}</p>
            {% endif %}
        </div>
        <div>
            <label for="{{ form.category.id_for_label }}" class="block text-sm font-medium text-gray-700">Category (Optional)</label>
            <select name="{{ form.category.name }}" id="{{ form.category.id_for_label }}"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                <option value="">Select a category</option>
                {% for category in form.category.field.queryset %}
                    <option value="{{ category.id }}" {% if form.category.value == category.id %}selected{% endif %}>
                        {{ category.name }}
                    </option>
                {% endfor %}
            </select>
            {% if form.category.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.category.errors }}</p>
            {% endif %}
        </div>
        <div>
            <label for="{{ form.priority.id_for_label }}" class="block text-sm font-medium text-gray-700">Priority</label>
            <select name="{{ form.priority.name }}" id="{{ form.priority.id_for_label }}"
                    class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                {% for priority in form.priority.field.queryset %}
                    <option value="{{ priority.id }}" {% if form.priority.value == priority.id %}selected{% endif %}>
                        {{ priority.name }}
                    </option>
                {% endfor %}
            </select>
            {% if form.priority.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.priority.errors }}</p>
            {% endif %}
        </div>
        <div>
            <label for="{{ form.attachments.id_for_label }}" class="block text-sm font-medium text-gray-700">Attachments (Optional)</label>
            <input type="file" name="{{ form.attachments.name }}" id="{{ form.attachments.id_for_label }}"
                    class="mt-1 block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-md file:border-0 file:bg-indigo-50 file:text-indigo-700 hover:file:bg-indigo-100"
                    multiple>
            <p class="mt-1 text-sm text-gray-500">{{ form.attachments.help_text }}</p>
            {% if form.attachments.errors %}
                <p class="mt-1 text-sm text-red-600">{{ form.attachments.errors }}</p>
            {% endif %}
        </div>
        <div>
            <button type="submit" class="w-full inline-flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500">
                Submit Ticket
            </button>
        </div>
    </form>
</div>

{% endblock customer_ticket_form %}



